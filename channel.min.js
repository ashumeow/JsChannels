(function(b,c,e){function a(q){var n=this,l,f=[],j=[],p=[],i={blocking:false},m;q=typeof q==="object"?q:{};for(m in i){if(typeof q[m]==="undefined"||q[m===null]){q[m]=i[m]}}function k(s,r){return function(){var t=s.apply(this,arguments);if(t&&typeof t.read==="function"){t.read(r.resolve);return r}else{return r.resolve()}}}function h(t){t=t===true?true:false;if(!l||l.state()!=="pending"||t){l=new c.Deferred();var s,r,u;if(!q.blocking){s=-1;r=j.length;while(++s<r){l.then(j[s])}}else{s=-1;r=p.length;while(++s<r){p[s].reject("Invalidating and replacing with a new deferred.")}p=[];s=-1;r=j.length;while(++s<r){u=new c.Deferred();c.when.apply(this,[l].concat(p)).then(k(j[s],u));p.push(u)}}}}this.read=function g(r){j.push(r);h(true);while(f.length>0){n.write.apply(n,f.shift())}return n};this.write=function o(){if(j.length===0){f.push(arguments)}else{h();l.resolve.apply(this,arguments)}return n}}a.alts=function(g){var j=Array.prototype.splice.call(arguments,1),k=-1,f=j.length,l;function h(){var i=Array.prototype.slice.call(arguments,0),m=i.shift();return function(){var n=Array.prototype.slice.call(arguments,0);return m.apply(this,i.concat(n))}}while(++k<f){l=j[k];l.read(h(g,l))}};b.BlockingChannel=function d(f){f=typeof f==="object"?f:{};f.blocking=true;a.call(this,f)};b.Channel=a}(this,jQuery));