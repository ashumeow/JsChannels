(function(c,d){function b(s){var p=this,e=[],m=[],g=-1,n=null,l=false,i={},o;s=typeof s==="object"?s:{};for(o in i){if(typeof s[o]==="undefined"||s[o===null]){s[o]=i[o]}}function j(){if(!l&&e.length>0){g=-1;n=e.shift();r.apply(this)}}function r(){if(++g>=m.length||n===null){g=-1;n=null;j.apply(this);return}m[g].apply(this,n);if(!l){r.apply(this)}}this.read=function f(t){m.push(t);j.apply(this);return p};this.unread=function f(u){var v=-1,t=m.length;while(++v<t){if(m[v]===u){m.splice(v,1);break}}return p};this.block=function h(){if(!l){l=true;return true}return false};this.unblock=function k(){if(l){l=false;r.apply(this);return true}return false};this.write=function q(){if(m.length===0||e.length>0||l){e.push(arguments)}else{n=arguments;r.apply(this)}return p}}function a(){var e=Array.prototype.slice.call(arguments,0),f=e.shift();return function(){var g=Array.prototype.slice.call(arguments,0);return f.apply(this,e.concat(g))}}b.alts=function(f){var g=Array.prototype.splice.call(arguments,1),h=-1,e=g.length,j;while(++h<e){j=g[h];j.read(a(f,j))}};b.select=function(f){var g=Array.prototype.splice.call(arguments,1),j=-1,e=g.length,l,h=[];function k(m,n){return a(function i(q){var p=-1,o=g.length;console.log("J is "+p);while(++p<o){g[p].unread(h[p])}return n.apply(q,arguments)},m)}while(++j<e){l=g[j];h.push(k(l,f));l.read(h[j])}};c.Channel=b}(this));